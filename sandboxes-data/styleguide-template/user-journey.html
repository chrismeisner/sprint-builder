<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>User Journey ‚Äì Brand Styleguide</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="tokens.css" />
  <link rel="stylesheet" href="base.css" />
  <link rel="stylesheet" href="sidebar-nav.css" />
  <style>

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: var(--font-family-sans);
      background: var(--neutral-50);
      color: var(--neutral-900);
      -webkit-font-smoothing: antialiased;
    }

    .wrap {
      max-width: 1400px;
      margin: auto;
      padding: 32px 16px 64px;
    }

    .page-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 24px;
    }

    .page-header-content {
      flex: 1;
    }

    h1 {
      margin: 0 0 8px;
      font-family: var(--font-family-sans);
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .subtitle {
      font-family: var(--font-family-sans);
      font-size: 15px;
      font-weight: 400;
      color: var(--neutral-600);
      margin: 0;
      line-height: 1.5;
    }

    .page-actions {
      display: flex;
      gap: 8px;
      flex-shrink: 0;
    }

    .export-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border-radius: 8px;
      border: 1px solid var(--neutral-200);
      background: var(--neutral-0);
      font-family: var(--font-family-sans);
      font-size: 13px;
      font-weight: 600;
      color: var(--neutral-700);
      cursor: pointer;
      transition: all 150ms ease;
    }

    .export-btn:hover {
      border-color: var(--brand-primary-400);
      color: var(--brand-primary-600);
      background: var(--brand-primary-50);
    }

    .export-btn svg {
      width: 16px;
      height: 16px;
    }

    @media (max-width: 500px) {
      .page-header {
        flex-direction: column;
      }
      .page-actions {
        width: 100%;
      }
      .export-btn {
        flex: 1;
        justify-content: center;
      }
    }

    /* User for this Journey */
    .journey-user {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 20px;
      background: var(--neutral-0);
      border: 1px solid var(--neutral-200);
      border-radius: var(--radius);
      margin-bottom: 28px;
      box-shadow: var(--shadow);
    }

    .journey-user-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--neutral-400);
      writing-mode: vertical-rl;
      text-orientation: mixed;
      transform: rotate(180deg);
    }

    .journey-user-avatar {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--brand-primary-100);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      flex-shrink: 0;
    }

    .journey-user-info {
      flex: 1;
      min-width: 0;
    }

    .journey-user-name {
      font-size: 17px;
      font-weight: 700;
      color: var(--neutral-900);
      margin: 0 0 2px;
    }

    .journey-user-role {
      font-size: 13px;
      color: var(--brand-primary-600);
      margin: 0 0 6px;
    }

    .journey-user-quote {
      font-size: 13px;
      font-style: italic;
      color: var(--neutral-500);
      margin: 0;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .journey-user-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .journey-user-info-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1px solid var(--neutral-200);
      background: var(--neutral-0);
      color: var(--neutral-500);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 150ms ease;
    }

    .journey-user-info-btn:hover {
      border-color: var(--brand-primary-400);
      color: var(--brand-primary-600);
      background: var(--brand-primary-50);
    }

    .journey-user-info-btn svg {
      width: 18px;
      height: 18px;
    }

    @media (max-width: 600px) {
      .journey-user {
        flex-wrap: wrap;
      }
      .journey-user-label {
        writing-mode: horizontal-tb;
        transform: none;
        width: 100%;
      }
    }

    /* User Modal */
    .user-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
      padding: 16px;
    }

    .user-modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .user-modal {
      background: var(--neutral-0);
      border-radius: var(--radius);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      max-width: 480px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      transform: translateY(20px);
      transition: transform 0.2s ease;
    }

    .user-modal-overlay.visible .user-modal {
      transform: translateY(0);
    }

    .user-modal-header {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 24px;
      background: linear-gradient(135deg, var(--brand-primary-50) 0%, var(--neutral-50) 100%);
      border-bottom: 1px solid var(--neutral-100);
    }

    .user-modal-avatar {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: var(--brand-primary-100);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      flex-shrink: 0;
      border: 3px solid var(--neutral-0);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .user-modal-identity {
      flex: 1;
    }

    .user-modal-name {
      margin: 0 0 4px;
      font-size: 22px;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .user-modal-role {
      margin: 0 0 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--brand-primary-600);
    }

    .user-modal-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .user-modal-tag {
      font-size: 11px;
      font-weight: 500;
      padding: 3px 8px;
      border-radius: 4px;
      background: var(--neutral-100);
      color: var(--neutral-600);
    }

    .user-modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: var(--neutral-0);
      color: var(--neutral-500);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 150ms ease;
    }

    .user-modal-close:hover {
      background: var(--neutral-100);
      color: var(--neutral-700);
    }

    .user-modal-close svg {
      width: 18px;
      height: 18px;
    }

    .user-modal-quote {
      padding: 20px 24px;
      background: var(--neutral-50);
      border-bottom: 1px solid var(--neutral-100);
    }

    .user-modal-quote blockquote {
      margin: 0;
      font-size: 15px;
      font-style: italic;
      line-height: 1.5;
      color: var(--neutral-700);
      position: relative;
      padding-left: 20px;
    }

    .user-modal-quote blockquote::before {
      content: '"';
      position: absolute;
      left: 0;
      top: -4px;
      font-size: 28px;
      font-style: normal;
      color: var(--brand-primary-300);
      font-family: Georgia, serif;
    }

    .user-modal-body {
      padding: 20px 24px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .user-modal-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .user-modal-section-header {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .user-modal-section-icon {
      font-size: 16px;
    }

    .user-modal-section-title {
      margin: 0;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--neutral-500);
    }

    .user-modal-section-content {
      font-size: 14px;
      line-height: 1.5;
      color: var(--neutral-700);
    }

    .user-modal-section-content ul {
      margin: 0;
      padding: 0 0 0 18px;
    }

    .user-modal-section-content li {
      margin-bottom: 4px;
    }

    .user-modal-section-content li:last-child {
      margin-bottom: 0;
    }

    .user-modal-goals {
      padding: 12px 14px;
      background: var(--brand-secondary-50, #f0fdf4);
      border: 1px solid var(--brand-secondary-200, #bbf7d0);
      border-radius: 8px;
    }

    .user-modal-goals .user-modal-section-title {
      color: var(--brand-secondary-700, #15803d);
    }

    .user-modal-goals .user-modal-section-content {
      color: var(--brand-secondary-800, #166534);
    }

    .user-modal-pains {
      padding: 12px 14px;
      background: var(--brand-tertiary-50, #fef2f2);
      border: 1px solid var(--brand-tertiary-200, #fecaca);
      border-radius: 8px;
    }

    .user-modal-pains .user-modal-section-title {
      color: var(--brand-tertiary-700, #b91c1c);
    }

    .user-modal-pains .user-modal-section-content {
      color: var(--brand-tertiary-800, #991b1b);
    }

    .user-modal-footer {
      padding: 16px 24px;
      background: var(--neutral-50);
      border-top: 1px solid var(--neutral-100);
    }

    .user-modal-stages {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .user-modal-stages-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--neutral-500);
    }

    .user-modal-stage-tag {
      font-size: 11px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--brand-primary-100);
      color: var(--brand-primary-700);
    }

    .journey-stage {
      flex: 0 0 calc((100% - 40px) / 3);
      background: var(--neutral-0);
      border: 1px solid var(--neutral-200);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Journey Carousel */
    .journey-carousel {
      position: relative;
      margin-bottom: 48px;
    }

    .carousel-container {
      overflow: hidden;
      cursor: grab;
    }

    .carousel-container:active {
      cursor: grabbing;
    }

    .carousel-container.is-dragging {
      cursor: grabbing;
    }

    .carousel-container.is-dragging .carousel-track {
      transition: none;
    }

    .carousel-track {
      display: flex;
      gap: 20px;
      transition: transform 0.4s ease;
    }

    .journey-stage {
      flex: 0 0 calc((100% - 40px) / 3);
      background: var(--neutral-0);
      border: 1px solid var(--neutral-200);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Tablet: 2 cards */
    @media (max-width: 900px) {
      .journey-stage {
        flex: 0 0 calc((100% - 20px) / 2);
      }
    }

    /* Mobile: 1 card */
    @media (max-width: 600px) {
      .journey-stage {
        flex: 0 0 100%;
      }
    }

    .stage-image {
      width: 100%;
      aspect-ratio: 4 / 3;
      overflow: hidden;
    }

    .stage-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      background: var(--neutral-100);
    }

    .stage-header {
      padding: 20px 20px 16px;
      border-bottom: 1px solid var(--neutral-100);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .stage-number {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--brand-primary-500);
      color: var(--neutral-0);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .stage-name {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .stage-body {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .stage-content {
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex: 1;
    }

    .stage-section {
      margin: 0;
    }

    .stage-label {
      font-size: 10px;
      font-weight: 600;
      color: var(--neutral-500);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 4px;
    }

    .stage-text {
      font-size: 13px;
      line-height: 1.4;
      color: var(--neutral-700);
      margin: 0;
    }

    .stage-list {
      margin: 0;
      padding: 0 0 0 16px;
      font-size: 13px;
      line-height: 1.5;
      color: var(--neutral-700);
    }

    .emotion-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 16px;
      font-size: 12px;
      font-weight: 500;
    }

    .emotion-positive {
      background: var(--brand-secondary-100);
      color: var(--brand-secondary-800);
    }

    .emotion-neutral {
      background: var(--neutral-100);
      color: var(--neutral-700);
    }

    .emotion-negative {
      background: var(--brand-tertiary-100);
      color: var(--brand-tertiary-800);
    }

    /* Stage Callouts */
    .stage-callouts {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: auto;
      padding-top: 12px;
      border-top: 1px solid var(--neutral-100);
    }

    .stage-callout {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 12px;
      line-height: 1.4;
    }

    .stage-callout-icon {
      flex-shrink: 0;
      font-size: 14px;
    }

    .stage-callout-content {
      flex: 1;
    }

    .stage-callout-label {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .callout-pain {
      background: var(--brand-tertiary-50, #fef2f2);
      border: 1px solid var(--brand-tertiary-200, #fecaca);
    }

    .callout-pain .stage-callout-label {
      color: var(--brand-tertiary-700, #b91c1c);
    }

    .callout-pain .stage-callout-text {
      color: var(--brand-tertiary-600, #dc2626);
    }

    .callout-opportunity {
      background: var(--brand-secondary-50, #f0fdf4);
      border: 1px solid var(--brand-secondary-200, #bbf7d0);
    }

    .callout-opportunity .stage-callout-label {
      color: var(--brand-secondary-700, #15803d);
    }

    .callout-opportunity .stage-callout-text {
      color: var(--brand-secondary-600, #16a34a);
    }

    /* Carousel Controls */
    .carousel-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-top: 20px;
    }

    .carousel-btn {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: 1px solid var(--neutral-200);
      background: var(--neutral-0);
      color: var(--neutral-700);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 150ms ease;
    }

    .carousel-btn:hover:not(:disabled) {
      border-color: var(--brand-primary-500);
      color: var(--brand-primary-500);
    }

    .carousel-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .carousel-btn svg {
      width: 20px;
      height: 20px;
    }

    .carousel-dots {
      display: flex;
      gap: 8px;
    }

    .carousel-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      border: none;
      background: var(--neutral-200);
      cursor: pointer;
      padding: 0;
      transition: all 150ms ease;
    }

    .carousel-dot:hover {
      background: var(--neutral-400);
    }

    .carousel-dot.active {
      background: var(--brand-primary-500);
      transform: scale(1.2);
    }

    .carousel-counter {
      font-size: 14px;
      color: var(--neutral-500);
      font-weight: 500;
      min-width: 60px;
      text-align: center;
    }

  </style>
</head>
<body>
  <div class="wrap">
    <div class="page-header">
      <div class="page-header-content">
        <h1>User Journey</h1>
        <p class="subtitle">Map of user stages, touchpoints, emotions, and opportunities throughout the experience.</p>
      </div>
      <div class="page-actions">
        <button class="export-btn" id="exportCsvBtn" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Export CSV
        </button>
      </div>
    </div>

    <!-- User for this Journey -->
    <div class="journey-user" id="journeyUser">
      <span class="journey-user-label">User</span>
      <div class="journey-user-avatar" id="journeyUserAvatar"></div>
      <div class="journey-user-info">
        <h3 class="journey-user-name" id="journeyUserName"></h3>
        <p class="journey-user-role" id="journeyUserRole"></p>
        <p class="journey-user-quote" id="journeyUserQuote"></p>
      </div>
      <div class="journey-user-actions">
        <button class="journey-user-info-btn" id="openUserModal" type="button" aria-label="View user details">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- User Detail Modal -->
    <div class="user-modal-overlay" id="userModalOverlay">
      <div class="user-modal" role="dialog" aria-labelledby="modalUserName">
        <button class="user-modal-close" id="closeUserModal" type="button" aria-label="Close modal">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
        <div class="user-modal-header">
          <div class="user-modal-avatar" id="modalUserAvatar"></div>
          <div class="user-modal-identity">
            <h2 class="user-modal-name" id="modalUserName"></h2>
            <p class="user-modal-role" id="modalUserRole"></p>
            <div class="user-modal-tags" id="modalUserTags"></div>
          </div>
        </div>
        <div class="user-modal-quote">
          <blockquote id="modalUserQuote"></blockquote>
        </div>
        <div class="user-modal-body">
          <div class="user-modal-section user-modal-goals">
            <div class="user-modal-section-header">
              <span class="user-modal-section-icon">üéØ</span>
              <h3 class="user-modal-section-title">Goals</h3>
            </div>
            <div class="user-modal-section-content">
              <ul id="modalUserGoals"></ul>
            </div>
          </div>
          <div class="user-modal-section user-modal-pains">
            <div class="user-modal-section-header">
              <span class="user-modal-section-icon">üò§</span>
              <h3 class="user-modal-section-title">Pain Points</h3>
            </div>
            <div class="user-modal-section-content">
              <ul id="modalUserPains"></ul>
            </div>
          </div>
          <div class="user-modal-section">
            <div class="user-modal-section-header">
              <span class="user-modal-section-icon">üîÑ</span>
              <h3 class="user-modal-section-title">Behaviors</h3>
            </div>
            <div class="user-modal-section-content">
              <ul id="modalUserBehaviors"></ul>
            </div>
          </div>
        </div>
        <div class="user-modal-footer">
          <div class="user-modal-stages">
            <span class="user-modal-stages-label">Key Journey Stages:</span>
            <div id="modalUserStages"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Journey Carousel -->
    <div class="journey-carousel" id="journeyCarousel">
      <div class="carousel-container">
        <div class="carousel-track" id="carouselTrack">
          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Awareness stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">1</div>
              <h2 class="stage-name">Awareness</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Find a solution to their problem</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Searches for solutions online</li>
                    <li>Asks peers for recommendations</li>
                    <li>Browses social media content</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">Google, social ads, blog posts, word of mouth</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-neutral">üòê Curious</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">Hard to find us among competitors</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">Create SEO content targeting pain points</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>

          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Consideration stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">2</div>
              <h2 class="stage-name">Consideration</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Evaluate if this is the right solution</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Reads landing page & features</li>
                    <li>Compares pricing with alternatives</li>
                    <li>Looks for reviews & case studies</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">Website, pricing page, G2/Capterra, demo video</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-neutral">ü§î Evaluating</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">Unclear value prop vs competitors</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">Add comparison table & social proof</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>

          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Decision stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">3</div>
              <h2 class="stage-name">Decision</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Sign up and start using the product</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Clicks "Sign Up" or "Start Trial"</li>
                    <li>Creates account / enters payment</li>
                    <li>Receives confirmation email</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">Sign-up form, checkout, welcome email</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-positive">üòä Hopeful</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">Too many steps in sign-up flow</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">Single-page checkout, social login</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>

          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Onboarding stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">4</div>
              <h2 class="stage-name">Onboarding</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Learn how to get value quickly</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Completes setup wizard</li>
                    <li>Watches tutorial or reads guide</li>
                    <li>Tries first key action</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">In-app wizard, tooltips, help docs, email drip</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-neutral">üßê Learning</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">Generic onboarding, no personalization</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">Role-based paths, quick "aha moment"</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>

          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Engagement stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">5</div>
              <h2 class="stage-name">Engagement</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Get consistent value, solve problems</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Uses core features regularly</li>
                    <li>Contacts support when stuck</li>
                    <li>Explores advanced features</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">Product UI, help center, chat support, emails</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-positive">üòÑ Satisfied</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">Hard to find help, slow support</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">In-app help, proactive check-ins</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>

          <article class="journey-stage">
            <div class="stage-image">
              <img src="images/image-placeholder.jpeg" alt="Advocacy stage illustration" />
            </div>
            <div class="stage-header">
              <div class="stage-number">6</div>
              <h2 class="stage-name">Advocacy</h2>
            </div>
            <div class="stage-body">
              <div class="stage-content">
                <div class="stage-section">
                  <div class="stage-label">User Goal</div>
                  <p class="stage-text">Share success, help others discover</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Actions</div>
                  <ul class="stage-list">
                    <li>Refers friends or colleagues</li>
                    <li>Leaves review or testimonial</li>
                    <li>Shares on social media</li>
                  </ul>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Touchpoints</div>
                  <p class="stage-text">Referral page, review prompts, social share</p>
                </div>
                <div class="stage-section">
                  <div class="stage-label">Emotion</div>
                  <span class="emotion-indicator emotion-positive">ü§© Delighted</span>
                </div>
                <div class="stage-callouts">
                  <div class="stage-callout callout-pain">
                    <span class="stage-callout-icon">‚ö†Ô∏è</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Pain Point</div>
                      <div class="stage-callout-text">No easy way to refer or share</div>
                    </div>
                  </div>
                  <div class="stage-callout callout-opportunity">
                    <span class="stage-callout-icon">üí°</span>
                    <div class="stage-callout-content">
                      <div class="stage-callout-label">Opportunity</div>
                      <div class="stage-callout-text">Referral rewards, 1-click share links</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </article>
        </div>
      </div>

      <div class="carousel-controls">
        <button class="carousel-btn" id="prevBtn" aria-label="Previous stage">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 18l-6-6 6-6"/>
          </svg>
        </button>
        <div class="carousel-dots" id="carouselDots"></div>
        <button class="carousel-btn" id="nextBtn" aria-label="Next stage">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </button>
      </div>
    </div>

  </div>
  <script src="sidebar-nav.js"></script>
  <script src="personas-data.js"></script>
  <script>
    (function() {
      // ============================================
      // USER FOR THIS JOURNEY
      // Uses the first persona from personas-data.js
      // ============================================
      let currentPersona = null;

      function renderJourneyUser() {
        if (typeof PERSONAS === 'undefined' || !PERSONAS.length) return;
        
        // Use first persona as the primary user for this journey
        currentPersona = PERSONAS[0];
        
        document.getElementById('journeyUserAvatar').textContent = currentPersona.emoji || 'üë§';
        document.getElementById('journeyUserName').textContent = currentPersona.name;
        document.getElementById('journeyUserRole').textContent = currentPersona.role;
        document.getElementById('journeyUserQuote').textContent = `"${currentPersona.quote}"`;
      }

      // ============================================
      // USER DETAIL MODAL
      // ============================================
      const modalOverlay = document.getElementById('userModalOverlay');
      const openModalBtn = document.getElementById('openUserModal');
      const closeModalBtn = document.getElementById('closeUserModal');

      function openModal() {
        if (!currentPersona) return;
        
        // Populate modal content
        document.getElementById('modalUserAvatar').textContent = currentPersona.emoji || 'üë§';
        document.getElementById('modalUserName').textContent = currentPersona.name;
        document.getElementById('modalUserRole').textContent = currentPersona.role;
        document.getElementById('modalUserQuote').textContent = currentPersona.quote;
        
        // Tags
        document.getElementById('modalUserTags').innerHTML = currentPersona.tags
          .map(tag => `<span class="user-modal-tag">${tag}</span>`)
          .join('');
        
        // Goals
        document.getElementById('modalUserGoals').innerHTML = currentPersona.goals
          .map(goal => `<li>${goal}</li>`)
          .join('');
        
        // Pain Points
        document.getElementById('modalUserPains').innerHTML = currentPersona.painPoints
          .map(pain => `<li>${pain}</li>`)
          .join('');
        
        // Behaviors
        document.getElementById('modalUserBehaviors').innerHTML = currentPersona.behaviors
          .map(behavior => `<li>${behavior}</li>`)
          .join('');
        
        // Journey Stages
        document.getElementById('modalUserStages').innerHTML = currentPersona.journeyStages
          .map(stage => `<span class="user-modal-stage-tag">${stage}</span>`)
          .join('');
        
        // Show modal
        modalOverlay.classList.add('visible');
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modalOverlay.classList.remove('visible');
        document.body.style.overflow = '';
      }

      // Event listeners
      openModalBtn.addEventListener('click', openModal);
      closeModalBtn.addEventListener('click', closeModal);
      
      // Close on overlay click
      modalOverlay.addEventListener('click', (e) => {
        if (e.target === modalOverlay) closeModal();
      });
      
      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modalOverlay.classList.contains('visible')) {
          closeModal();
        }
      });

      // Initialize
      renderJourneyUser();

      // ============================================
      // CSV EXPORT
      // ============================================
      const exportBtn = document.getElementById('exportCsvBtn');

      function escapeCSV(str) {
        // Escape quotes and wrap in quotes if contains comma, quote, or newline
        if (str == null) return '';
        const s = String(str);
        if (s.includes(',') || s.includes('"') || s.includes('\n')) {
          return '"' + s.replace(/"/g, '""') + '"';
        }
        return s;
      }

      function getStageData() {
        const stageElements = document.querySelectorAll('.journey-stage');
        const data = [];

        stageElements.forEach((stage, index) => {
          const name = stage.querySelector('.stage-name')?.textContent.trim() || '';
          const goal = stage.querySelector('.stage-section:nth-child(1) .stage-text')?.textContent.trim() || '';
          
          // Get actions as a list
          const actionsList = stage.querySelectorAll('.stage-section:nth-child(2) .stage-list li');
          const actions = Array.from(actionsList).map(li => li.textContent.trim()).join('; ');
          
          const touchpoints = stage.querySelector('.stage-section:nth-child(3) .stage-text')?.textContent.trim() || '';
          const emotion = stage.querySelector('.emotion-indicator')?.textContent.trim() || '';
          
          const painPoint = stage.querySelector('.callout-pain .stage-callout-text')?.textContent.trim() || '';
          const opportunity = stage.querySelector('.callout-opportunity .stage-callout-text')?.textContent.trim() || '';

          data.push({
            stage: index + 1,
            name,
            goal,
            actions,
            touchpoints,
            emotion,
            painPoint,
            opportunity
          });
        });

        return data;
      }

      function exportToCSV() {
        const data = getStageData();
        
        // CSV header
        const headers = ['Stage', 'Name', 'User Goal', 'Actions', 'Touchpoints', 'Emotion', 'Pain Point', 'Opportunity'];
        
        // Build CSV content
        let csv = headers.map(escapeCSV).join(',') + '\n';
        
        data.forEach(row => {
          csv += [
            row.stage,
            escapeCSV(row.name),
            escapeCSV(row.goal),
            escapeCSV(row.actions),
            escapeCSV(row.touchpoints),
            escapeCSV(row.emotion),
            escapeCSV(row.painPoint),
            escapeCSV(row.opportunity)
          ].join(',') + '\n';
        });

        // Add persona info at the end
        if (currentPersona) {
          csv += '\n';
          csv += 'User Profile\n';
          csv += `Name,${escapeCSV(currentPersona.name)}\n`;
          csv += `Role,${escapeCSV(currentPersona.role)}\n`;
          csv += `Tags,${escapeCSV(currentPersona.tags.join('; '))}\n`;
          csv += `Quote,${escapeCSV(currentPersona.quote)}\n`;
          csv += '\n';
          csv += 'Demographics\n';
          if (currentPersona.demographics) {
            csv += `Age,${escapeCSV(currentPersona.demographics.age)}\n`;
            csv += `Location,${escapeCSV(currentPersona.demographics.location)}\n`;
            csv += `Tech Level,${escapeCSV(currentPersona.demographics.techLevel)}\n`;
            csv += `Budget,${escapeCSV(currentPersona.demographics.budget)}\n`;
          }
          csv += '\n';
          csv += `Goals,${escapeCSV(currentPersona.goals.join('; '))}\n`;
          csv += `Pain Points,${escapeCSV(currentPersona.painPoints.join('; '))}\n`;
          csv += `Behaviors,${escapeCSV(currentPersona.behaviors.join('; '))}\n`;
          csv += `Key Journey Stages,${escapeCSV(currentPersona.journeyStages.join('; '))}\n`;
        }

        // Create download
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.setAttribute('href', url);
        link.setAttribute('download', 'user-journey.csv');
        link.style.display = 'none';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
      }

      exportBtn.addEventListener('click', exportToCSV);

      // ============================================
      // CAROUSEL LOGIC
      // ============================================
      const carousel = document.getElementById('journeyCarousel');
      const container = carousel.querySelector('.carousel-container');
      const track = document.getElementById('carouselTrack');
      const stages = track.querySelectorAll('.journey-stage');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const dotsContainer = document.getElementById('carouselDots');
      
      let currentIndex = 0;
      const totalStages = stages.length;
      const gap = 20; // matches CSS gap

      // Drag state
      let isDragging = false;
      let startX = 0;
      let currentTranslate = 0;
      let prevTranslate = 0;
      let animationId = null;

      function getVisibleCount() {
        const width = carousel.offsetWidth;
        if (width <= 600) return 1;
        if (width <= 900) return 2;
        return 3;
      }

      function getMaxIndex() {
        return Math.max(0, totalStages - getVisibleCount());
      }

      function getSlideWidth() {
        const visibleCount = getVisibleCount();
        return (carousel.offsetWidth - (gap * (visibleCount - 1))) / visibleCount + gap;
      }

      // Create dots for each position
      function createDots() {
        dotsContainer.innerHTML = '';
        const maxIndex = getMaxIndex();
        for (let i = 0; i <= maxIndex; i++) {
          const dot = document.createElement('button');
          dot.className = 'carousel-dot' + (i === currentIndex ? ' active' : '');
          dot.setAttribute('aria-label', `Go to position ${i + 1}`);
          dot.addEventListener('click', () => goToSlide(i));
          dotsContainer.appendChild(dot);
        }
      }

      function setTrackPosition() {
        track.style.transform = `translateX(${currentTranslate}px)`;
      }

      function updateCarousel(animate = true) {
        const slideWidth = getSlideWidth();
        currentTranslate = -currentIndex * slideWidth;
        prevTranslate = currentTranslate;
        
        if (animate) {
          track.style.transition = 'transform 0.4s ease';
        }
        setTrackPosition();
        
        // Update dots
        const dots = dotsContainer.querySelectorAll('.carousel-dot');
        dots.forEach((dot, i) => {
          dot.classList.toggle('active', i === currentIndex);
        });

        // Update button states
        prevBtn.disabled = currentIndex === 0;
        nextBtn.disabled = currentIndex >= getMaxIndex();
      }

      function goToSlide(index) {
        currentIndex = Math.max(0, Math.min(index, getMaxIndex()));
        updateCarousel();
      }

      function nextSlide() {
        if (currentIndex < getMaxIndex()) {
          currentIndex++;
          updateCarousel();
        }
      }

      function prevSlide() {
        if (currentIndex > 0) {
          currentIndex--;
          updateCarousel();
        }
      }

      // Drag/Grab functionality
      function getPositionX(e) {
        return e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
      }

      function dragStart(e) {
        isDragging = true;
        startX = getPositionX(e);
        prevTranslate = -currentIndex * getSlideWidth();
        
        container.classList.add('is-dragging');
        track.style.transition = 'none';
        
        if (animationId) cancelAnimationFrame(animationId);
        animationId = requestAnimationFrame(animationLoop);
      }

      function drag(e) {
        if (!isDragging) return;
        
        const currentX = getPositionX(e);
        const diff = currentX - startX;
        currentTranslate = prevTranslate + diff;
        
        // Add resistance at edges
        const maxTranslate = 0;
        const minTranslate = -getMaxIndex() * getSlideWidth();
        
        if (currentTranslate > maxTranslate) {
          currentTranslate = maxTranslate + (currentTranslate - maxTranslate) * 0.3;
        } else if (currentTranslate < minTranslate) {
          currentTranslate = minTranslate + (currentTranslate - minTranslate) * 0.3;
        }
      }

      function dragEnd() {
        if (!isDragging) return;
        isDragging = false;
        
        container.classList.remove('is-dragging');
        cancelAnimationFrame(animationId);
        
        const slideWidth = getSlideWidth();
        const movedBy = currentTranslate - prevTranslate;
        const threshold = slideWidth * 0.2; // 20% threshold
        
        // Determine direction and snap
        if (movedBy < -threshold && currentIndex < getMaxIndex()) {
          currentIndex++;
        } else if (movedBy > threshold && currentIndex > 0) {
          currentIndex--;
        }
        
        updateCarousel(true);
      }

      function animationLoop() {
        if (isDragging) {
          setTrackPosition();
          animationId = requestAnimationFrame(animationLoop);
        }
      }

      // Mouse events
      container.addEventListener('mousedown', dragStart);
      container.addEventListener('mousemove', drag);
      container.addEventListener('mouseup', dragEnd);
      container.addEventListener('mouseleave', dragEnd);

      // Touch events
      container.addEventListener('touchstart', dragStart, { passive: true });
      container.addEventListener('touchmove', drag, { passive: true });
      container.addEventListener('touchend', dragEnd);

      // Prevent drag on links/buttons inside cards
      track.querySelectorAll('a, button').forEach(el => {
        el.addEventListener('mousedown', e => e.stopPropagation());
        el.addEventListener('touchstart', e => e.stopPropagation());
      });

      // Prevent image drag
      track.querySelectorAll('img').forEach(img => {
        img.addEventListener('dragstart', e => e.preventDefault());
      });

      // Button click handlers
      prevBtn.addEventListener('click', prevSlide);
      nextBtn.addEventListener('click', nextSlide);

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') prevSlide();
        if (e.key === 'ArrowRight') nextSlide();
      });

      // Handle resize
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          currentIndex = Math.min(currentIndex, getMaxIndex());
          createDots();
          updateCarousel(false);
        }, 100);
      });

      // Initialize
      createDots();
      updateCarousel(false);
    })();
  </script>
</body>
</html>
